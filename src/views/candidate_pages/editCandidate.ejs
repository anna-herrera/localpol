<!-- views/candidate_pages/editCandidate.ejs -->

<!DOCTYPE html>
<html lang="en">
<head>
    <% include ../partials/firebase_auth %>
    <script type="text/javascript">
    //   initApp = function() {
    //     console.log("AAAAAAAAAAAAAABBBBBBBBBBBBB")
    //     firebase.auth().onAuthStateChanged(function(user) {
    //       if (user) {
    //         var photoURL = user.photoURL;
    //         console.log("I have a photo url = " + photoURL);
    //         if (photoURL) {
    //             document.getElementById('profilePic') = photoURL;
    //         }
    //       } else {
    //         window.location.href = '/candidates/login'; // TODO change this to forbidden page
    //         // User is signed out.
    //         document.getElementById('sign-in-status').textContent = 'Signed out';
    //         document.getElementById('sign-in').textContent = 'Sign in';
    //         document.getElementById('account-details').textContent = 'null';
    //       }
    //     }, function(error) {
    //       console.log(error);
    //     });
    //   };

    //   window.addEventListener('load', function() {
    //     initApp();
    //   });
    </script>
    <% include ../partials/head %>
</head>
<body>

<!-- views/candidate_pages/editCandidate.ejs -->
<!-- todo: make sure that userid matches url -->

<header>
    <% include ../partials/header %>
</header>

<main class="container">
    <div class="container">
        <div class="row row-centered">
            <img id="profilePic" src="<%= photoURL %>" class="img-circle" style="width: 150px; height: 150px;" alt=<%= data.name %> />
            <h1><%= data.name %></h1>
        </div>

        <form method="POST" action=<%= '/candidates/candidate/' + userId + '/edit' %>>
            <div class="row row-centered">
                <h4>Bio</h4>
                <textarea name="bio" style="width:800px; height:75px"><%= data.bio %></textarea><br>
            </div>
            <div class="row row-centered">
                <h4>Platform</h4>
                <textarea name="platform" style="width:800px; height:75px"><%= data.platform %></textarea><br>
            </div>
            <div class="row row-centered">
                <input type="submit" value="Update bio and platform" class="btn btn-default btn-md">
            </div>
        </form>

        <div class="row">
            <h4>Upcoming Elections</h4>
            <div class="list-group">  
                <% if (!data.electionIds) {%>
                    <p>You have not registered for any elections (register below)</p>
                <% }%>

                <% for(var i in data.electionIds) { %>
                    <% console.log(i); %>
                    <a href="/election/<%= data.electionIds[i].title%>" class="list-group-item"><%= data.electionIds[i].title %></a>
                <% } %>
            </div>
        </div>
        <div class="row row row-centered">
            <form action=<%= '/candidates/candidate/' + userId + '/addElection' %> method="POST">
                <div class="row">
                    <select name="electionSelector" class="selectpicker" data-show-subtext="true" data-live-search="true">
                        <% for (var i in electionList) {%>
                            <option value="<%= i %>"><%= electionList[i].title %></option>
                        <% } %>
                    </select>
                    <input type="submit" value="Add Election" class="btn btn-default btn-md">
                </div>
            </form>
        </div>

    </div>
</main>

</body>
</html>